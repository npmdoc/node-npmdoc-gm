<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/aheckmann/gm">gm (v1.23.0)</a>
</h1>
<h4>GraphicsMagick and ImageMagick for node.js</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.gm">module gm</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.gm">
            function <span class="apidocSignatureSpan"></span>gm
            <span class="apidocSignatureSpan">(source, height, color)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.compare">
            function <span class="apidocSignatureSpan">gm.</span>compare
            <span class="apidocSignatureSpan">(orig, compareTo, options, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.subClass">
            function <span class="apidocSignatureSpan">gm.</span>subClass
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.super_">
            function <span class="apidocSignatureSpan">gm.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.toString">
            function <span class="apidocSignatureSpan">gm.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gm.</span>identifyHelpers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">gm.</span>utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">gm.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.gm.identifyHelpers">module gm.identifyHelpers</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.identifyHelpers.Colors">
            function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Colors
            <span class="apidocSignatureSpan">(o, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.identifyHelpers.Depth">
            function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Depth
            <span class="apidocSignatureSpan">(o, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.identifyHelpers.Format">
            function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Format
            <span class="apidocSignatureSpan">(o, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.identifyHelpers.Geometry">
            function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Geometry
            <span class="apidocSignatureSpan">(o, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.identifyHelpers.Orientation">
            function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Orientation
            <span class="apidocSignatureSpan">(o, val)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.gm.utils">module gm.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.utils.argsToArray">
            function <span class="apidocSignatureSpan">gm.utils.</span>argsToArray
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.utils.escape">
            function <span class="apidocSignatureSpan">gm.utils.</span>escape
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.utils.isUtil">
            function <span class="apidocSignatureSpan">gm.utils.</span>isUtil
            <span class="apidocSignatureSpan">(v)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.gm.utils.unescape">
            function <span class="apidocSignatureSpan">gm.utils.</span>unescape
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gm" id="apidoc.module.gm">module gm</a></h1>


    <h2>
        <a href="#apidoc.element.gm.gm" id="apidoc.element.gm.gm">
        function <span class="apidocSignatureSpan"></span>gm
        <span class="apidocSignatureSpan">(source, height, color)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function gm(source, height, color) {
  var width;

  if (!(this instanceof gm)) {
    return new gm(source, height, color);
  }

  EventEmitter.call(this);

  this._options = {};
  this.options(this.__proto__._options);

  this.data = {};
  this._in = [];
  this._out = [];
  this._outputFormat = null;
  this._subCommand = 'convert';

  if (source instanceof Stream) {
    this.sourceStream = source;
    source = height || 'unknown.jpg';
  } else if (Buffer.isBuffer(source)) {
    this.sourceBuffer = source;
    source = height || 'unknown.jpg';
  } else if (height) {
    // new images
    width = source;
    source = "";

    this.in("-size", width + "x" + height);

    if (color) {
      this.in("xc:"+ color);
    }
  }

  if (typeof source === "string") {
    // then source is a path

    // parse out gif frame brackets from filename
    // since stream doesn't use source path
    // eg. "filename.gif[0]"
    var frames = source.match(/(\[.+\])$/);
    if (frames) {
      this.sourceFrames = source.substr(frames.index, frames[0].length);
      source = source.substr(0, frames.index);
    }
  }

  this.source = source;

  this.addSrcFormatter(function (src) {
    // must be first source formatter

    var inputFromStdin = this.sourceStream || this.sourceBuffer;
    var ret = inputFromStdin ? '-' : this.source;

    if (ret &amp;&amp; this.sourceFrames) ret += this.sourceFrames;

    src.length = 0;
    src[0] = ret;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.compare" id="apidoc.element.gm.compare">
        function <span class="apidocSignatureSpan">gm.</span>compare
        <span class="apidocSignatureSpan">(orig, compareTo, options, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compare(orig, compareTo, options, cb) {

  var isImageMagick = this._options &amp;&amp; this._options.imageMagick;
  var appPath = this._options &amp;&amp; this._options.appPath || '';
  var bin = isImageMagick
    ? appPath + 'compare'
    : appPath + 'gm'
  var args = ['-metric', 'mse', orig, compareTo]
  if (!isImageMagick) {
      args.unshift('compare');
  }
  var tolerance = 0.4;
  // outputting the diff image
  if (typeof options === 'object') {

    if (options.highlightColor &amp;&amp; options.highlightColor.indexOf('"') &lt; 0) {
      options.highlightColor = '"' + options.highlightColor + '"';
    }

    if (options.file) {
      if (typeof options.file !== 'string') {
        throw new TypeError('The path for the diff output is invalid');
      }
       // graphicsmagick defaults to red
      if (options.highlightColor) {
          args.push('-highlight-color');
          args.push(options.highlightColor);
      }
      if (options.highlightStyle) {
          args.push('-highlight-style')
          args.push(options.highlightStyle)
      }
      // For IM, filename is the last argument. For GM it's `-file &lt;filename&gt;`
      if (!isImageMagick) {
          args.push('-file');
      }
      args.push(options.file);
    }

    if (typeof options.tolerance != 'undefined') {
      if (typeof options.tolerance !== 'number') {
        throw new TypeError('The tolerance value should be a number');
      }
      tolerance = options.tolerance;
    }
  } else {
    // For ImageMagick diff file is required but we don't care about it, so null it out
    if (isImageMagick) {
      args.push('null:');
    }

    if (typeof options == 'function') {
      cb = options; // tolerance value not provided, flip the cb place
    } else {
      tolerance = options
    }
  }

  var proc = spawn(bin, args);
  var stdout = '';
  var stderr = '';
  proc.stdout.on('data',function(data) { stdout+=data });
  proc.stderr.on('data',function(data) { stderr+=data });
  proc.on('close', function (code) {
    // ImageMagick returns err code 2 if err, 0 if similar, 1 if dissimilar
    if (isImageMagick) {
      if (code === 0) {
        return cb(null, 0 &lt;= tolerance, 0, stdout);
      }
      else if (code === 1) {
        err = null;
        stdout = stderr;
      } else {
      return cb(stderr);
      }
    } else {
      if(code !== 0) {
        return cb(stderr);
      }
    }
    // Since ImageMagick similar gives err code 0 and no stdout, there's really no matching
    // Otherwise, output format for IM is `12.00 (0.123)` and for GM it's `Total: 0.123`
    var regex = isImageMagick ? /\((\d+\.?[\d\-\+e]*)\)/m : /Total: (\d+\.?\d*)/m;
    var match = regex.exec(stdout);
    if (!match) {
      err = new Error('Unable to parse output.\nGot ' + stdout);
      return cb(err);
    }

    var equality = parseFloat(match[1]);
    cb(null, equality &lt;= tolerance, equality, stdout, orig, compareTo);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  - image output
    - **write** - writes the processed image data to the specified filename
    - **stream** - provides a `ReadableStream` with the processed image data
    - **toBuffer** - returns the image as a `Buffer` instead of a stream

##compare

Graphicsmagicks `compare` command is exposed through `gm.<span class="apidocCodeKeywordSpan">compare</span>()`. This allows us to
 determine if two images can be considered "equal".

Currently `gm.compare` only accepts file paths.

    gm.compare(path1, path2 [, options], callback)

```js
gm.compare('/path/to/image1.jpg', '/path/to/another.png', function (err, isEqual, equality, raw, path1, path2
) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.subClass" id="apidoc.element.gm.subClass">
        function <span class="apidocSignatureSpan">gm.</span>subClass
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function subClass(options) {
  function gm (source, height, color) {
    if (!(this instanceof parent)) {
      return new gm(source, height, color);
    }

    parent.call(this, source, height, color);
  }

  gm.prototype.__proto__ = parent.prototype;
  gm.prototype._options = {};
  gm.prototype.options(options);

  return gm;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## Use ImageMagick instead of gm

Subclass `gm` to enable ImageMagick

```js
var fs = require('fs')
  , gm = require('gm').<span class="apidocCodeKeywordSpan">subClass</span>({imageMagick: true});

// resize and remove EXIF profile data
gm('/path/to/my/img.jpg')
.resize(240, 240)
...
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.super_" id="apidoc.element.gm.super_">
        function <span class="apidocSignatureSpan">gm.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.toString" id="apidoc.element.gm.toString">
        function <span class="apidocSignatureSpan">gm.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
    return toString;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gm.identifyHelpers" id="apidoc.module.gm.identifyHelpers">module gm.identifyHelpers</a></h1>


    <h2>
        <a href="#apidoc.element.gm.identifyHelpers.Colors" id="apidoc.element.gm.identifyHelpers.Colors">
        function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Colors
        <span class="apidocSignatureSpan">(o, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Colors(o, val) {
  o.color = parseInt(val, 10);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.identifyHelpers.Depth" id="apidoc.element.gm.identifyHelpers.Depth">
        function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Depth
        <span class="apidocSignatureSpan">(o, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Depth(o, val) {
  o.depth = parseInt(val, 10);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.identifyHelpers.Format" id="apidoc.element.gm.identifyHelpers.Format">
        function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Format
        <span class="apidocSignatureSpan">(o, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Format(o, val) {
  o.format = val.split(" ")[0];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.identifyHelpers.Geometry" id="apidoc.element.gm.identifyHelpers.Geometry">
        function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Geometry
        <span class="apidocSignatureSpan">(o, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Geometry(o, val) {
  // We only want the size of the first frame.
  // Each frame is separated by a space.
  var split = val.split(" ").shift().split("x");
  var width = parseInt(split[0], 10);
  var height = parseInt(split[1], 10);
  if (o.size &amp;&amp; o.size.width &amp;&amp; o.size.height) {
    if (width &gt; o.size.width) o.size.width = width;
    if (height &gt; o.size.height) o.size.height = height;
  } else {
    o.size = {
      width:  width,
      height: height
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.identifyHelpers.Orientation" id="apidoc.element.gm.identifyHelpers.Orientation">
        function <span class="apidocSignatureSpan">gm.identifyHelpers.</span>Orientation
        <span class="apidocSignatureSpan">(o, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Orientation(o, val) {
  if (val in orientations) {
    o['Profile-EXIF'] || (o['Profile-EXIF'] = {});
    o['Profile-EXIF'].Orientation = val;
    o.Orientation = orientations[val];
  } else {
    o.Orientation = val || 'Unknown';
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.gm.utils" id="apidoc.module.gm.utils">module gm.utils</a></h1>


    <h2>
        <a href="#apidoc.element.gm.utils.argsToArray" id="apidoc.element.gm.utils.argsToArray">
        function <span class="apidocSignatureSpan">gm.utils.</span>argsToArray
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">argsToArray = function (args) {
  var arr = [];

  for (var i = 0; i &lt;= arguments.length; i++) {
    if ('undefined' != typeof arguments[i])
      arr.push(arguments[i]);
  }

  return arr;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.utils.escape" id="apidoc.element.gm.utils.escape">
        function <span class="apidocSignatureSpan">gm.utils.</span>escape
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escape(arg) {
  return '"' + String(arg).trim().replace(/"/g, '\\"') + '"';
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.utils.isUtil" id="apidoc.element.gm.utils.isUtil">
        function <span class="apidocSignatureSpan">gm.utils.</span>isUtil
        <span class="apidocSignatureSpan">(v)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isUtil = function (v) {
	var ty = 'object';
	switch (Object.prototype.toString.call(v)) {
	case '[object String]':
		ty = 'String';
		break;
	case '[object Array]':
		ty = 'Array';
		break;
	case '[object Boolean]':
		ty = 'Boolean';
		break;
	}
	return ty;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.gm.utils.unescape" id="apidoc.element.gm.utils.unescape">
        function <span class="apidocSignatureSpan">gm.utils.</span>unescape
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escape(arg) {
    return String(arg).trim().replace(/"/g, "");
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>